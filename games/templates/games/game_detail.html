
<!DOCTYPE html>
<html>
<head>
    <title>Tic Tac Toe - {{ game.room_name }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; text-align: center; }
        .board { display: inline-block; margin: 20px; }
        .board-row { display: flex; }
        .square { width: 80px; height: 80px; border: 2px solid #333; display: flex; align-items: center; justify-content: center; font-size: 24px; background: white; cursor: pointer; }
        .square:hover { background: #f0f0f0; }
        .square:disabled { cursor: not-allowed; background: #f8f8f8; }
        .btn { padding: 10px 15px; margin: 5px; background: #007bff; color: white; text-decoration: none; border-radius: 4px; display: inline-block; }
        .btn-danger { background: #dc3545; }
    </style>
</head>
<body>
    <h1>{{ game.room_name }}</h1>
    <p>Owner: {{ game.owner.username }}</p>
    <p>Current Player: {{ game.get_active_player_display }}</p>
    
    {% if game.game_state == 'active' %}
        <p>Game in Progress</p>
    {% elif game.game_state == 'won' %}
        <p>Player {{ game.winner }} Wins!</p>
    {% elif game.game_state == 'tie' %}
        <p>It's a Tie!</p>
    {% endif %}

    {% if is_owner and game.game_state == 'active' %}
    <div class="board">
        {% for row in board %}
        <div class="board-row">
            {% for cell in row %}
            {% with position=forloop.parentloop.counter0|add:forloop.parentloop.counter0|add:forloop.parentloop.counter0|add:forloop.counter0 %}
            <form method="post" action="{% url 'make_move' game.id %}" style="display: inline;">
                {% csrf_token %}
                <input type="hidden" name="position" value="{{ position }}">
                <button type="submit" class="square" {% if cell != ' ' %}disabled{% endif %}>
                    {% if cell == 'X' %}❌{% elif cell == 'O' %}⭕{% endif %}
                </button>
            </form>
            {% endwith %}
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="board">
        {% for row in board %}
        <div class="board-row">
            {% for cell in row %}
            <div class="square">
                {% if cell == 'X' %}❌{% elif cell == 'O' %}⭕{% endif %}
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div style="margin-top: 20px;">
        {% if is_owner %}
        <a href="{% url 'delete_game' game.id %}" class="btn btn-danger">Delete Game</a>
        {% endif %}
        <a href="{% url 'game_list' %}" class="btn">Back to Game List</a>
    </div>
</body>
</html>